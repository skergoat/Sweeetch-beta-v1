{# offers index #}
{% extends 'base-front.html.twig' %}

{% block title %} {{ parent() }} - Alternances {% endblock %}

{% block body %}

<div class="background-jobs">

    <div class="container-fluid container-jobs">

        <header id="header">

            <div id="topbar">
            <div class="container">
                <div class="social-links">
                <a href="https://twitter.com/SweeetchA" target="_blank" class="twitter"><i class="fa fa-twitter"></i></a>
                <a href="https://www.facebook.com/sweeetch.ton.alternance/" target="_blank" class="facebook"><i class="fa fa-facebook"></i></a>
                <a href="https://fr.linkedin.com/company/sweetchmontpellier?trk=public_profile_topcard_current_company" target="_blank" class="linkedin"><i class="fa fa-linkedin"></i></a>
                <a href="https://www.instagram.com/sweeetch_alternance/" target="_blank" class="instagram"><i class="fa fa-instagram"></i></a>
                </div>
            </div>
            </div>
            {# nav #}
            <div class="container nav-desktop">
        
                <nav class="nav-jobs main-nav d-none d-lg-block">
                    <ul>
                        <li class="active"><a href="/">Acceuil</a></li>
                        {% if page is defined %}
                        {% else %}
                        <li><a href="{{ path('offers_index', {'page':1}) }}">Alternances</a></li>
                        {% endif %}
                        {% if is_granted('ROLE_USER') %}
                            {% if is_granted('ROLE_ADMIN') %}
                            <li><a href="/admin">ADMIN</a></li>
                            {% elseif  is_granted('ROLE_STUDENT') %}
                            <li><a href="{{ path('student_show', {'id': app.user.student.id}) }}">MON PROFILE</a></li>
                            {% elseif  is_granted('ROLE_COMPANY') %}
                            <li><a href="{{ path('company_show', {'id': app.user.company.id}) }}">MON ENTREPRISE</a></li>
                            {% elseif  is_granted('ROLE_SCHOOL') %}
                            <li><a href="{{ path('school_show', {'id': app.user.school.id}) }}">MON ECOLE</a></li>
                            {% endif %} 
                        <li><a href="/logout">DECONNEXION</a></li>
                        {% else %}
                        <li class="drop-down"><a>S'INSCRIRE</a>
                            <ul>
                                <li><a href="/student/new">Etudiants</a></li>
                                <li><a href="/company/new">Entreprises</a></li>
                                <li><a href="/school/new">Ecoles</a></li>
                            </ul>
                        </li> 
                        <li><a href="/login/">CONNEXION</a></li>
                        {% endif %}
                    </ul>
                </nav>
            
            </div>
        </header>

    <div class="jobs-container">

        <h1>Alternances</h1>
        <br>
        {# success message #}
        {% for message in app.flashes('error') %}
        <div class="alert alert-danger">
            {{ message }}
        </div>
        {% endfor %}
        
        {% if offers is not empty %}
        {# option menu #}
        <form method="get" action="{{ path('find') }}" style="margin:auto;width:300px;" id="form-options">
            <p>
                <div style="display:flex;justify-content:center;align-items:center;">
                    <label style="text-align:center;">Quel est votre domaine ?</label><button class="btn btn-primary" style="margin:10px;"><i class="fa fa-search"></i></button>
                </div>
                <select name="domain" id="domain">
                    <option value="Administration">Administration & législation</option>
                    <option value="Batiment">Bâtiment & construction</option>
                    <option value="Communication">Communication</option>
                    <option value="Culture">Culture</option>
                    <option value="Economie">Economie & gestion</option>
                    <option value="Environnement">Environnement & nature</option>
                    <option value="Hotellerie">Hôtellerie & alimentation</option>
                    <option value="Informatique">Informatique & télécommunication</option>
                    <option value="Sante">Santé & bien-être</option>
                    <option value="Sciences">Sciences</option>
                    <option value="Sciences-humaines">Sciences humaines & sociales</option>
                    <option value="Securite">Sécurité</option>
                    <option value="Technique">Technique & industrie</option>
                    <option value="Tourisme">Tourisme, sports & loisirs</option>
                    <option value="Transports">Transports & logistique</option>
                </select>
                <input type="hidden" name="_token" value="{{ csrf_token('find' ~ page) }}">
            </p>
        </form>

        <div class="row">
            {# paginate #}
            <div class="pagination-top">{{ knp_pagination_render(offers) }}</div>
                {% for offer in offers %}
                    {% if offer.applies[0] is not defined or offer.applies[0] is defined and offer.applies[0].hired == false and offer.applies[0].confirmed == false and offer.applies[0].finished == false %}
                    {# render offers #}
                    <div class="offers-index card col-lg-5 mr-2 ml-2 mt-2 mb-2">
                        <a  href="{{ path('offers_show', {'id': offer.id, 'page':page}) }}" class="card-link">
                            <div class="card-header" style="display:flex;">
                                {% if offer.company.pictures.fileName is defined %}
                                <div class="image" style="margin-right:15px;">
                                    <img src="{{ uploaded_asset(offer.company.pictures.fileName) }}" class="profile_picture elevation-2" alt="User Image">
                                </div>
                                {% else %}
                                <div style="margin-right:15px;">
                                    <img src="https://via.placeholder.com/30" />                        
                                </div>
                                {% endif %}
                                <div style="width:100%;display:flex;justify-content:space-between;">
                                    <div><h6 style="color: #6c757d !important">{{ offer.company.companyName }}</h6></div>
                                    <div style="color:#6c757d;font-weight:700;">{{ offer.domain }}</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="card-text"> 
                                    <div style="margin-right:20px;">
                                        <h3>{{ offer.title }}</h3>
                                    </div> 
                                    <div><h5 class="card-subtitle mb-2 text-muted">{{ offer.location }}</h5></div>
                                </div>
                            </div>
                        </a>
                    </div>
                    {# no offers #}
                    {% else %}
                    <tr>
                        <td colspan="8">
                            
                            <div class="info-box mb-3" id="no-offers">
                                <span class="info-box-icon bg-warning elevation-1"><i class="fa fa-info"></i></span>
                
                                <div class="info-box-content">
                                    <span class="info-box-number">Aucune alternance pour le moment</span>
                                    <!-- <span class="info-box-text">Revenez plus tard !</span> -->
                                </div>
                            </div>

                        </td>
                    </tr> 
                    {% endif %}
                {% endfor %} 
            {% else %}
            <tr>
                <td colspan="8">
        
                    <div class="info-box mb-3" id="no-offers">
                        <span class="info-box-icon bg-warning elevation-1"><i class="fa fa-info"></i></span>
        
                        <div class="info-box-content">
                            <span class="info-box-number">Aucune alternance pour le moment</span>
                            <!-- <span class="info-box-text">Revenez plus tard !</span> -->
                        </div>
                    </div>
                            
                </td>
            </tr> 
            {% endif %}
            </div>
            <div class="pagination-bottom">{{ knp_pagination_render(offers) }}</div> 
        </div>
    </div>
</div>
{# footer #}
<footer id="footer" class="section-bg">
    <div class="container">
        <div class="copyright">
        &copy; Copyright <strong>SWEEETCH</strong>. All Rights Reserved
        </div>
        <div class="credits">
        L'équipe de SWEEETCH
        </div>
    </div>
</footer>

{% endblock %}
