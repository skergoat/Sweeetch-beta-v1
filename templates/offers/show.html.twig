{% extends 'base-front.html.twig' %}

{% block title %} {{ parent() }} - Emploi {% endblock %}

{% block body %}

<div class="background-jobs">
    <div class="container container-jobs">

        <header id="header">

            <div id="topbar">
            <div class="container">
                <div class="social-links">
                <a href="https://twitter.com/SweeetchA" target="_blank" class="twitter"><i class="fa fa-twitter"></i></a>
                <a href="https://www.facebook.com/sweeetch.ton.alternance/" target="_blank" class="facebook"><i class="fa fa-facebook"></i></a>
                <a href="https://fr.linkedin.com/company/sweetchmontpellier?trk=public_profile_topcard_current_company" target="_blank" class="linkedin"><i class="fa fa-linkedin"></i></a>
                <a href="https://www.instagram.com/sweeetch_alternance/" target="_blank" class="instagram"><i class="fa fa-instagram"></i></a>
                </div>
            </div>
            </div>
        
            <div class="container nav-desktop">
                <nav class="nav-jobs main-nav d-none d-lg-block">
                    <ul>
                        <li><a href="/offers/">Emplois</a></li> 
                        {% if is_granted('ROLE_ADMIN') %}
                        <li><a href="/admin">ADMIN</a></li>
                        {% elseif  is_granted('ROLE_STUDENT') %}
                        <li><a href="{{ path('student_show', {'id': app.user.student.id}) }}">MON PROFILE</a></li>
                        {% elseif  is_granted('ROLE_COMPANY') %}
                        <li><a href="{{ path('company_show', {'id': app.user.company.id}) }}">MON ENTREPRISE</a></li>
                        {% elseif  is_granted('ROLE_SCHOOL') %}
                        <li><a href="{{ path('school_show', {'id': app.user.school.id}) }}">MON ECOLE</a></li>
                        {% endif %}
                    </ul>
                </nav>
            </div>
        </header>

        <h1 class="titles-front">{{ offers.title }}</h1>
        <h4 class="card-subtitle mb-2 text-muted">{{ offers.location }}</h4>

        {% for message in app.flashes('success') %}
        <div class="alert alert-success">
            {{ message }}
        </div>
        {% endfor %}

        <div class="Password card col-lg-12">
            <div class="card-body">
                <table class="table offers-show col-lg-5 col-md-5 col-sm-12 col-xs-12">
                    <tbody>
                        <tr>
                            <th>Lieu</th>
                            <td>{{ offers.location }}</td>
                        </tr>
                        <tr>
                            <th>Domaine</th>
                            <td>{{ offers.domain }}</td>
                        </tr>
                        <tr>
                            <th>Du</th>
                            <td>{{ offers.dateStart ? offers.dateStart|date('d-m-Y') : '' }}</td>
                        </tr>
                        <tr>
                            <th>Au</th>
                            <td>{{ offers.dateEnd ? offers.dateEnd|date('d-m-Y') : '' }}</td>
                        </tr>
                    </tbody>
                </table>

                <div class="description">
                    <h5>Description</h5>
                    <p>{{ offers.description|raw }}</p>
                </div>
        
                {% if app.user.student.id is defined %}
                    {% if is_granted('ROLE_SUPER_STUDENT') %}
                        {% if offers.state == false %}
                        <form method="post" action="{{ path('apply', { id:offers.id, student_id: app.user.student.id }) }}">
                            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ offers.id) }}">
                            <button class="btn btn-success">Postuler</button>
                        </form> 
                        {% else %}
                        <div class="col-12 col-sm-6 col-md-6">
                            <div class="info-box mb-3">
                              <span class="info-box-icon bg-warning elevation-1"><i class="fa fa-info"></i></span>
                
                              <div class="info-box-content">
                                <span class="info-box-number">Dossier en cours</span>
                                <span class="info-box-text">Controllez votre profil</span>
                              </div>
                              <!-- /.info-box-content -->
                            </div>
                            <!-- /.info-box -->
                        </div>
                        {% endif %}
                    {% elseif is_granted('ROLE_STUDENT') %}
                    <div class="col-12 col-sm-6 col-md-6">
                        <div class="info-box mb-3">
                          <span class="info-box-icon bg-danger elevation-1"><i class="fa fa-exclamation-triangle"></i></span>
            
                          <div class="info-box-content">
                            <span class="info-box-number">Validation en attente</span>
                            <span class="info-box-text">Votre compte doit être validé pour pouvoir postuler</span>
                          </div>
                          <!-- /.info-box-content -->
                        </div>
                        <!-- /.info-box -->
                    </div>
                    {% endif %}
                {% endif %}
            </div>
        </div>

    </div>
</div>

<footer id="footer" class="section-bg">
    <div class="container">
        <div class="copyright">
        &copy; Copyright <strong>SWEEETCH</strong>. All Rights Reserved
        </div>
        <div class="credits">
        L'équipe de SWEEETCH
        </div>
    </div>
</footer>

{% endblock %}

